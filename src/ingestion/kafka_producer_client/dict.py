test = {
  "symbol": "ZPTA",
  "data": {
    "Meta Data": {
      "1. Information": "Intraday (5min) open, high, low, close prices and volume",
      "2. Symbol": "ZPTA",
      "3. Last Refreshed": "2024-05-17 19:55:00",
      "4. Interval": "5min",
      "5. Output Size": "Compact",
      "6. Time Zone": "US/Eastern"
    },
    "Time Series (5min)": {
      "2024-05-17 19:55:00": {
        "1. open": "0.9200",
        "2. high": "0.9200",
        "3. low": "0.9200",
        "4. close": "0.9200",
        "5. volume": "200"
      },
      "2024-05-17 19:45:00": {
        "1. open": "0.9200",
        "2. high": "0.9200",
        "3. low": "0.9200",
        "4. close": "0.9200",
        "5. volume": "4"
      },
      "2024-05-17 19:40:00": {
        "1. open": "0.9200",
        "2. high": "0.9200",
        "3. low": "0.9200",
        "4. close": "0.9200",
        "5. volume": "100"
      },
      "2024-05-17 19:15:00": {
        "1. open": "0.9200",
        "2. high": "0.9200",
        "3. low": "0.9200",
        "4. close": "0.9200",
        "5. volume": "100"
      },
      "2024-05-17 19:00:00": {
        "1. open": "0.9200",
        "2. high": "0.9200",
        "3. low": "0.9200",
        "4. close": "0.9200",
        "5. volume": "36"
      },
      "2024-05-17 18:55:00": {
        "1. open": "0.9200",
        "2. high": "0.9200",
        "3. low": "0.9000",
        "4. close": "0.9000",
        "5. volume": "4"
      },
      "2024-05-17 18:45:00": {
        "1. open": "0.9000",
        "2. high": "0.9000",
        "3. low": "0.9000",
        "4. close": "0.9000",
        "5. volume": "17"
      },
      "2024-05-17 18:35:00": {
        "1. open": "0.9200",
        "2. high": "0.9200",
        "3. low": "0.9200",
        "4. close": "0.9200",
        "5. volume": "500"
      },
      "2024-05-17 18:20:00": {
        "1. open": "0.9200",
        "2. high": "0.9200",
        "3. low": "0.9200",
        "4. close": "0.9200",
        "5. volume": "50"
      },
      "2024-05-17 18:15:00": {
        "1. open": "0.9200",
        "2. high": "0.9200",
        "3. low": "0.9200",
        "4. close": "0.9200",
        "5. volume": "5"
      },
      "2024-05-17 18:05:00": {
        "1. open": "0.9000",
        "2. high": "0.9000",
        "3. low": "0.9000",
        "4. close": "0.9000",
        "5. volume": "231"
      },
      "2024-05-17 18:00:00": {
        "1. open": "0.9000",
        "2. high": "0.9000",
        "3. low": "0.9000",
        "4. close": "0.9000",
        "5. volume": "2"
      },
      "2024-05-17 17:55:00": {
        "1. open": "0.9050",
        "2. high": "0.9100",
        "3. low": "0.9000",
        "4. close": "0.9000",
        "5. volume": "1375"
      },
      "2024-05-17 17:45:00": {
        "1. open": "0.9000",
        "2. high": "0.9000",
        "3. low": "0.9000",
        "4. close": "0.9000",
        "5. volume": "400"
      },
      "2024-05-17 17:40:00": {
        "1. open": "0.9090",
        "2. high": "0.9090",
        "3. low": "0.9000",
        "4. close": "0.9000",
        "5. volume": "124"
      },
      "2024-05-17 17:30:00": {
        "1. open": "0.9090",
        "2. high": "0.9150",
        "3. low": "0.9000",
        "4. close": "0.9000",
        "5. volume": "7000"
      },
      "2024-05-17 17:25:00": {
        "1. open": "0.9150",
        "2. high": "0.9300",
        "3. low": "0.9150",
        "4. close": "0.9300",
        "5. volume": "1343"
      },
      "2024-05-17 17:20:00": {
        "1. open": "0.9200",
        "2. high": "0.9200",
        "3. low": "0.9170",
        "4. close": "0.9170",
        "5. volume": "62"
      },
      "2024-05-17 17:15:00": {
        "1. open": "0.9150",
        "2. high": "0.9150",
        "3. low": "0.9150",
        "4. close": "0.9150",
        "5. volume": "1"
      },
      "2024-05-17 17:05:00": {
        "1. open": "0.9150",
        "2. high": "0.9150",
        "3. low": "0.9150",
        "4. close": "0.9150",
        "5. volume": "67"
      },
      "2024-05-17 17:00:00": {
        "1. open": "0.9150",
        "2. high": "0.9150",
        "3. low": "0.9150",
        "4. close": "0.9150",
        "5. volume": "1570"
      },
      "2024-05-17 16:55:00": {
        "1. open": "0.9150",
        "2. high": "0.9160",
        "3. low": "0.9150",
        "4. close": "0.9150",
        "5. volume": "132"
      },
      "2024-05-17 16:50:00": {
        "1. open": "0.9150",
        "2. high": "0.9150",
        "3. low": "0.9150",
        "4. close": "0.9150",
        "5. volume": "1940"
      },
      "2024-05-17 16:45:00": {
        "1. open": "0.9200",
        "2. high": "0.9200",
        "3. low": "0.9150",
        "4. close": "0.9150",
        "5. volume": "12"
      },
      "2024-05-17 16:35:00": {
        "1. open": "0.9150",
        "2. high": "0.9150",
        "3. low": "0.9150",
        "4. close": "0.9150",
        "5. volume": "200"
      },
      "2024-05-17 16:30:00": {
        "1. open": "0.9240",
        "2. high": "0.9240",
        "3. low": "0.9150",
        "4. close": "0.9150",
        "5. volume": "301"
      },
      "2024-05-17 16:25:00": {
        "1. open": "0.9240",
        "2. high": "0.9240",
        "3. low": "0.9150",
        "4. close": "0.9240",
        "5. volume": "566"
      },
      "2024-05-17 16:20:00": {
        "1. open": "0.9240",
        "2. high": "0.9240",
        "3. low": "0.9200",
        "4. close": "0.9200",
        "5. volume": "1080"
      },
      "2024-05-17 16:15:00": {
        "1. open": "0.9240",
        "2. high": "0.9240",
        "3. low": "0.9240",
        "4. close": "0.9240",
        "5. volume": "38"
      },
      "2024-05-17 16:10:00": {
        "1. open": "0.9150",
        "2. high": "0.9150",
        "3. low": "0.9150",
        "4. close": "0.9150",
        "5. volume": "203"
      },
      "2024-05-17 16:00:00": {
        "1. open": "0.9160",
        "2. high": "0.9240",
        "3. low": "0.9100",
        "4. close": "0.9240",
        "5. volume": "16256"
      },
      "2024-05-17 15:55:00": {
        "1. open": "0.9150",
        "2. high": "0.9160",
        "3. low": "0.9150",
        "4. close": "0.9160",
        "5. volume": "1699"
      },
      "2024-05-17 15:50:00": {
        "1. open": "0.9240",
        "2. high": "0.9240",
        "3. low": "0.9180",
        "4. close": "0.9210",
        "5. volume": "944"
      },
      "2024-05-17 15:45:00": {
        "1. open": "0.9290",
        "2. high": "0.9300",
        "3. low": "0.9180",
        "4. close": "0.9290",
        "5. volume": "2650"
      },
      "2024-05-17 15:40:00": {
        "1. open": "0.9300",
        "2. high": "0.9300",
        "3. low": "0.9230",
        "4. close": "0.9300",
        "5. volume": "3304"
      },
      "2024-05-17 15:35:00": {
        "1. open": "0.9200",
        "2. high": "0.9280",
        "3. low": "0.9200",
        "4. close": "0.9260",
        "5. volume": "3079"
      },
      "2024-05-17 15:25:00": {
        "1. open": "0.9180",
        "2. high": "0.9190",
        "3. low": "0.9150",
        "4. close": "0.9150",
        "5. volume": "3992"
      },
      "2024-05-17 15:20:00": {
        "1. open": "0.9230",
        "2. high": "0.9230",
        "3. low": "0.9170",
        "4. close": "0.9170",
        "5. volume": "7981"
      },
      "2024-05-17 15:15:00": {
        "1. open": "0.9230",
        "2. high": "0.9260",
        "3. low": "0.9160",
        "4. close": "0.9160",
        "5. volume": "2498"
      },
      "2024-05-17 15:10:00": {
        "1. open": "0.9230",
        "2. high": "0.9260",
        "3. low": "0.9230",
        "4. close": "0.9260",
        "5. volume": "2176"
      },
      "2024-05-17 15:05:00": {
        "1. open": "0.9270",
        "2. high": "0.9270",
        "3. low": "0.9270",
        "4. close": "0.9270",
        "5. volume": "824"
      },
      "2024-05-17 15:00:00": {
        "1. open": "0.9230",
        "2. high": "0.9230",
        "3. low": "0.9230",
        "4. close": "0.9230",
        "5. volume": "1888"
      },
      "2024-05-17 14:55:00": {
        "1. open": "0.9150",
        "2. high": "0.9200",
        "3. low": "0.9150",
        "4. close": "0.9200",
        "5. volume": "5442"
      },
      "2024-05-17 14:50:00": {
        "1. open": "0.9230",
        "2. high": "0.9230",
        "3. low": "0.9160",
        "4. close": "0.9160",
        "5. volume": "323"
      },
      "2024-05-17 14:45:00": {
        "1. open": "0.9300",
        "2. high": "0.9300",
        "3. low": "0.9300",
        "4. close": "0.9300",
        "5. volume": "1273"
      },
      "2024-05-17 14:40:00": {
        "1. open": "0.9150",
        "2. high": "0.9150",
        "3. low": "0.9150",
        "4. close": "0.9150",
        "5. volume": "236"
      },
      "2024-05-17 14:35:00": {
        "1. open": "0.9300",
        "2. high": "0.9300",
        "3. low": "0.9150",
        "4. close": "0.9150",
        "5. volume": "4168"
      },
      "2024-05-17 14:30:00": {
        "1. open": "0.9300",
        "2. high": "0.9300",
        "3. low": "0.9300",
        "4. close": "0.9300",
        "5. volume": "336"
      },
      "2024-05-17 14:25:00": {
        "1. open": "0.9230",
        "2. high": "0.9230",
        "3. low": "0.9230",
        "4. close": "0.9230",
        "5. volume": "134"
      },
      "2024-05-17 14:15:00": {
        "1. open": "0.9230",
        "2. high": "0.9300",
        "3. low": "0.9150",
        "4. close": "0.9150",
        "5. volume": "3144"
      },
      "2024-05-17 14:10:00": {
        "1. open": "0.9090",
        "2. high": "0.9310",
        "3. low": "0.9090",
        "4. close": "0.9310",
        "5. volume": "292"
      },
      "2024-05-17 14:05:00": {
        "1. open": "0.9340",
        "2. high": "0.9340",
        "3. low": "0.9140",
        "4. close": "0.9140",
        "5. volume": "40656"
      },
      "2024-05-17 14:00:00": {
        "1. open": "0.9300",
        "2. high": "0.9370",
        "3. low": "0.9300",
        "4. close": "0.9370",
        "5. volume": "2512"
      },
      "2024-05-17 13:55:00": {
        "1. open": "0.9310",
        "2. high": "0.9320",
        "3. low": "0.9310",
        "4. close": "0.9310",
        "5. volume": "1909"
      },
      "2024-05-17 13:50:00": {
        "1. open": "0.9370",
        "2. high": "0.9370",
        "3. low": "0.9300",
        "4. close": "0.9300",
        "5. volume": "3782"
      },
      "2024-05-17 13:45:00": {
        "1. open": "0.9360",
        "2. high": "0.9360",
        "3. low": "0.9300",
        "4. close": "0.9300",
        "5. volume": "3990"
      },
      "2024-05-17 13:40:00": {
        "1. open": "0.9360",
        "2. high": "0.9360",
        "3. low": "0.9340",
        "4. close": "0.9340",
        "5. volume": "1112"
      },
      "2024-05-17 13:35:00": {
        "1. open": "0.9290",
        "2. high": "0.9370",
        "3. low": "0.9290",
        "4. close": "0.9300",
        "5. volume": "23016"
      },
      "2024-05-17 13:30:00": {
        "1. open": "0.9200",
        "2. high": "0.9250",
        "3. low": "0.9200",
        "4. close": "0.9250",
        "5. volume": "2484"
      },
      "2024-05-17 13:25:00": {
        "1. open": "0.9250",
        "2. high": "0.9300",
        "3. low": "0.9250",
        "4. close": "0.9290",
        "5. volume": "1230"
      },
      "2024-05-17 13:20:00": {
        "1. open": "0.9230",
        "2. high": "0.9230",
        "3. low": "0.9110",
        "4. close": "0.9110",
        "5. volume": "8172"
      },
      "2024-05-17 13:15:00": {
        "1. open": "0.9300",
        "2. high": "0.9380",
        "3. low": "0.9210",
        "4. close": "0.9380",
        "5. volume": "14545"
      },
      "2024-05-17 13:10:00": {
        "1. open": "0.9150",
        "2. high": "0.9300",
        "3. low": "0.9090",
        "4. close": "0.9300",
        "5. volume": "49406"
      },
      "2024-05-17 13:05:00": {
        "1. open": "0.9140",
        "2. high": "0.9140",
        "3. low": "0.9110",
        "4. close": "0.9110",
        "5. volume": "556"
      },
      "2024-05-17 13:00:00": {
        "1. open": "0.9140",
        "2. high": "0.9140",
        "3. low": "0.9140",
        "4. close": "0.9140",
        "5. volume": "1279"
      },
      "2024-05-17 12:55:00": {
        "1. open": "0.9000",
        "2. high": "0.9090",
        "3. low": "0.9000",
        "4. close": "0.9090",
        "5. volume": "7569"
      },
      "2024-05-17 12:50:00": {
        "1. open": "0.9200",
        "2. high": "0.9200",
        "3. low": "0.9060",
        "4. close": "0.9060",
        "5. volume": "3903"
      },
      "2024-05-17 12:45:00": {
        "1. open": "0.9100",
        "2. high": "0.9200",
        "3. low": "0.9100",
        "4. close": "0.9100",
        "5. volume": "1681"
      },
      "2024-05-17 12:40:00": {
        "1. open": "0.9200",
        "2. high": "0.9200",
        "3. low": "0.9060",
        "4. close": "0.9100",
        "5. volume": "3106"
      },
      "2024-05-17 12:35:00": {
        "1. open": "0.9000",
        "2. high": "0.9200",
        "3. low": "0.9000",
        "4. close": "0.9200",
        "5. volume": "20953"
      },
      "2024-05-17 12:30:00": {
        "1. open": "0.8940",
        "2. high": "0.9090",
        "3. low": "0.8940",
        "4. close": "0.9080",
        "5. volume": "29168"
      },
      "2024-05-17 12:25:00": {
        "1. open": "0.8800",
        "2. high": "0.8900",
        "3. low": "0.8800",
        "4. close": "0.8900",
        "5. volume": "8512"
      },
      "2024-05-17 12:20:00": {
        "1. open": "0.8860",
        "2. high": "0.8860",
        "3. low": "0.8810",
        "4. close": "0.8810",
        "5. volume": "7460"
      },
      "2024-05-17 12:15:00": {
        "1. open": "0.8810",
        "2. high": "0.8860",
        "3. low": "0.8810",
        "4. close": "0.8860",
        "5. volume": "383"
      },
      "2024-05-17 12:10:00": {
        "1. open": "0.8810",
        "2. high": "0.8810",
        "3. low": "0.8740",
        "4. close": "0.8740",
        "5. volume": "15947"
      },
      "2024-05-17 12:05:00": {
        "1. open": "0.8840",
        "2. high": "0.8860",
        "3. low": "0.8820",
        "4. close": "0.8860",
        "5. volume": "1585"
      },
      "2024-05-17 12:00:00": {
        "1. open": "0.8890",
        "2. high": "0.8890",
        "3. low": "0.8810",
        "4. close": "0.8840",
        "5. volume": "4003"
      },
      "2024-05-17 11:55:00": {
        "1. open": "0.8890",
        "2. high": "0.8890",
        "3. low": "0.8810",
        "4. close": "0.8890",
        "5. volume": "1952"
      },
      "2024-05-17 11:50:00": {
        "1. open": "0.8900",
        "2. high": "0.8900",
        "3. low": "0.8810",
        "4. close": "0.8810",
        "5. volume": "417"
      },
      "2024-05-17 11:45:00": {
        "1. open": "0.8970",
        "2. high": "0.8980",
        "3. low": "0.8720",
        "4. close": "0.8900",
        "5. volume": "34781"
      },
      "2024-05-17 11:40:00": {
        "1. open": "0.8970",
        "2. high": "0.8970",
        "3. low": "0.8890",
        "4. close": "0.8900",
        "5. volume": "1044"
      },
      "2024-05-17 11:35:00": {
        "1. open": "0.8800",
        "2. high": "0.8970",
        "3. low": "0.8800",
        "4. close": "0.8810",
        "5. volume": "17117"
      },
      "2024-05-17 11:30:00": {
        "1. open": "0.8750",
        "2. high": "0.8800",
        "3. low": "0.8750",
        "4. close": "0.8800",
        "5. volume": "9456"
      },
      "2024-05-17 11:25:00": {
        "1. open": "0.8830",
        "2. high": "0.8830",
        "3. low": "0.8710",
        "4. close": "0.8730",
        "5. volume": "30296"
      },
      "2024-05-17 11:20:00": {
        "1. open": "0.8860",
        "2. high": "0.8860",
        "3. low": "0.8830",
        "4. close": "0.8830",
        "5. volume": "2289"
      },
      "2024-05-17 11:15:00": {
        "1. open": "0.8910",
        "2. high": "0.8910",
        "3. low": "0.8870",
        "4. close": "0.8880",
        "5. volume": "14800"
      },
      "2024-05-17 11:10:00": {
        "1. open": "0.8960",
        "2. high": "0.8960",
        "3. low": "0.8880",
        "4. close": "0.8880",
        "5. volume": "3592"
      },
      "2024-05-17 11:05:00": {
        "1. open": "0.8980",
        "2. high": "0.9050",
        "3. low": "0.8890",
        "4. close": "0.8960",
        "5. volume": "9946"
      },
      "2024-05-17 11:00:00": {
        "1. open": "0.8980",
        "2. high": "0.8980",
        "3. low": "0.8980",
        "4. close": "0.8980",
        "5. volume": "2661"
      },
      "2024-05-17 10:55:00": {
        "1. open": "0.9010",
        "2. high": "0.9050",
        "3. low": "0.8980",
        "4. close": "0.8980",
        "5. volume": "3642"
      },
      "2024-05-17 10:50:00": {
        "1. open": "0.8980",
        "2. high": "0.9010",
        "3. low": "0.8980",
        "4. close": "0.9010",
        "5. volume": "1058"
      },
      "2024-05-17 10:45:00": {
        "1. open": "0.9050",
        "2. high": "0.9050",
        "3. low": "0.8980",
        "4. close": "0.8980",
        "5. volume": "1510"
      },
      "2024-05-17 10:40:00": {
        "1. open": "0.9000",
        "2. high": "0.9050",
        "3. low": "0.8880",
        "4. close": "0.9000",
        "5. volume": "61296"
      },
      "2024-05-17 10:35:00": {
        "1. open": "0.9080",
        "2. high": "0.9080",
        "3. low": "0.9000",
        "4. close": "0.9000",
        "5. volume": "2217"
      },
      "2024-05-17 10:30:00": {
        "1. open": "0.9000",
        "2. high": "0.9000",
        "3. low": "0.9000",
        "4. close": "0.9000",
        "5. volume": "1244"
      },
      "2024-05-17 10:25:00": {
        "1. open": "0.9020",
        "2. high": "0.9020",
        "3. low": "0.8920",
        "4. close": "0.9000",
        "5. volume": "8400"
      },
      "2024-05-17 10:20:00": {
        "1. open": "0.9080",
        "2. high": "0.9080",
        "3. low": "0.8920",
        "4. close": "0.9070",
        "5. volume": "3261"
      },
      "2024-05-17 10:15:00": {
        "1. open": "0.8930",
        "2. high": "0.9100",
        "3. low": "0.8930",
        "4. close": "0.9080",
        "5. volume": "20735"
      },
      "2024-05-17 10:10:00": {
        "1. open": "0.8910",
        "2. high": "0.8990",
        "3. low": "0.8900",
        "4. close": "0.8990",
        "5. volume": "2554"
      },
      "2024-05-17 10:05:00": {
        "1. open": "0.8880",
        "2. high": "0.8990",
        "3. low": "0.8880",
        "4. close": "0.8930",
        "5. volume": "9237"
      }
    }
  }
}


import pyspark
from pyspark.sql import SparkSession
from dbruntime.dbutils import DBUtils


configs = {
    "fs.azure.account.auth.type": "OAuth",
    "fs.azure.account.oauth.provider.type": "org.apache.hadoop.fs.azurebfs.oauth2.ClientCredsTokenProvider",
    "fs.azure.account.oauth2.client.id": dbutils.secrets.get(scope="keyvault-managed", key="servicePrincipalApplicationId"),
    "fs.azure.account.oauth2.client.secret": dbutils.secrets.get(scope="keyvault-managed", key="servicePrincipalSecret"),
    "fs.azure.account.oauth2.client.endpoint": "https://login.microsoftonline.com/a7c58d37-1d06-4472-a5e7-7c725497b4be/oauth2/token"
}
 
# Initialize Spark session
spark = SparkSession.builder.appName("tickerlist").getOrCreate()

# Apply the configurations for ADLS Gen2
for config_key, config_value in configs.items():
    spark.conf.set(config_key, config_value)

print('attached')

'''   
from src.common import utils


market_hours_gen = utils.market_hours_generator('2023-05-17')
for _ in market_hours_gen:  
    print(next(market_hours_gen))


print(datetime.today().strftime('%Y-%m-%d %H:%M:%S'))

symbol = test['symbol']
latest = test['data']["Time Series (5min)"]['2024-05-17 19:55:00']
latest_info = {'symbol':symbol,'data':latest}



print(latest_info)

'''
